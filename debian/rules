#!/usr/bin/make -f
# -*- makefile -*-

# Uncomment this to turn on verbose mode.
export DH_VERBOSE=1
export DH_ALWAYS_EXCLUDE=CVS:.git

override_dh_testdir:
	helpers/makedeb.sh check_versions
	dh_testdir

override_dh_install:
	dh_install
	install -p -m 755 -d $(CURDIR)/debian/python3-oq-libs/opt/openquake
	install -p -m 755 -d $(CURDIR)/debian/python3-oq-libs/opt/openquake/bin
	helpers/whlsetup.sh -3 -d $(CURDIR)/debian/python3-oq-libs/opt/openquake -s py -s py35
	install -p -m 755 -d $(CURDIR)/debian/python3-oq-libs/opt/openquake/lib/python3.5/site-packages/openquake
	install -p -m 644 openquake/__init__.py $(CURDIR)/debian/python3-oq-libs/opt/openquake/lib/python3.5/site-packages/openquake
	install -p -m 755 -d $(CURDIR)/debian/python3-oq-libs/opt/openquake/lib/python3.5/site-packages/openquake/libs
	install -p -m 644 openquake/libs/__init__.py $(CURDIR)/debian/python3-oq-libs/opt/openquake/lib/python3.5/site-packages/openquake/libs
	/opt/openquake/bin/python3 -m compileall $(CURDIR)/debian/python3-oq-libs/opt/openquake || true
	# Extra
	install -p -m 755 -d $(CURDIR)/debian/python3-oq-libs-extra/opt/openquake
	helpers/whlsetup.sh -3 -n -d $(CURDIR)/debian/python3-oq-libs-extra/opt/openquake -s py35-extra
	install -p -m 644 openquake/__init__.py $(CURDIR)/debian/python3-oq-libs-extra/opt/openquake/lib/python3.5/site-packages/mpl_toolkits
	/opt/openquake/bin/python3 -m compileall $(CURDIR)/debian/python3-oq-libs-extra/opt/openquake || true

override_dh_shlibdeps:
	echo "skip dh_shlibdeps"

override_dh_strip:
	echo "skip dh_strip"

%:
	dh  $@
